datagrids:
    base-panel-grid:
        source:
            type: orm
            acl_resource: cb_newage_panel_view
            query:
                select:
                    - panel.id
                    - panel.name
                    - stype.name as support
                    - ltype.name as lighting
                    - panel.dimensions
                    - c.name as city
                from:
                    - { table: %cb_newage_panel.entity.class%, alias: panel }
                join:
                    left:
                        -
                            join: panel.supportType
                            alias: stype
                        -
                            join: panel.lightingType
                            alias: ltype
                        - { join: panel.addresses, alias: addr, conditionType: WITH, condition: 'addr.primary = true' }
                        -
                            join: addr.city
                            alias: c
        columns:
            id:
                label:        cb.newage.panel.id.label
            name:
                label:        cb.newage.panel.name.label
            support:
                label:        cb.newage.supporttype.entity_label
            lighting:
                label:        cb.newage.lightingtype.entity_label
            dimensions:
                label:        cb.newage.panel.dimensions.label
            city:
                label:        oro.address.city.label
        sorters:
            columns:
                id:
                    data_name: panel.id
                name:
                    data_name: panel.name
                support:
                    data_name: stype.name
                lighting:
                    data_name: ltype.name
                city:
                    data_name: c.name
            default:
                city:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                name:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
        filters:
            columns:
                name:
                    type: string
                    data_name: panel.name
                    enabled: true
                support:
                    type:      choice
                    data_name: panel.supportType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_support_type.entity.class%)
                            translatable_options: false
                lighting:
                    type:      choice
                    data_name: panel.lightingType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_lighting_type.entity.class%)
                            translatable_options: false
                city:
                    type:      choice
                    data_name: addr.city
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_city.entity.class%)
                            translatable_options: false
        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_panel_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_panel_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_panel_api_delete_panel
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_panel_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_panel_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_panel_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    panel-grid:
        extends: base-panel-grid

    base-panel_view-grid:
        source:
            type: orm
            acl_resource: cb_newage_panel_view_view
            query:
                select:
                    - panelView.id
                    - panelView.name
                    - panel.name as panelName
                    - panelView.poster
                    - panelView.price
                from:
                    - { table: %cb_newage_panel_view.entity.class%, alias: panelView }
                join:
                    left:
                        -
                            join: panelView.panel
                            alias: panel
        columns:
            panelName:
                label:        cb.newage.panel.entity_label
            name:
                label:        cb.newage.panelview.name.label
            poster:
                label:        cb.newage.panelview.poster.label
            price:
                label:        cb.newage.panelview.price.label
                type:             localized_number
                method:           formatCurrency
                context_resolver: Oro\Bundle\MagentoBundle\Grid\FormatterContextResolver::getResolverCurrencyClosure
                align:            left
        sorters:
            columns:
                name:
                    data_name: panelView.name
                panelName:
                    data_name: panel.name
        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_panel_view_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_panel_view_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_panel_view_api_delete_panel_view
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_panel_view_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_panel_view_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_panel_view_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

        filters:
            columns:
                panelName:
                    type: entity
                    data_name: panelView.panel
                    options:
                        field_options:
                            class: CBNewAgeBundle:Panel
                poster:
                    type: string
                    data_name: panelView.poster
                price:
                    type:             currency
                    data_name:        panelView.price
                    options:
                        data_type:    Oro\Bundle\FilterBundle\Form\Type\Filter\NumberFilterType::DATA_DECIMAL

    panel_view-grid:
        extends: base-panel_view-grid

    panel-panel_views-grid:
        extends: base-panel_view-grid
        source:
            query:
                where:
                    and:
                        - ( panel.id = :panel_id)
            bind_parameters:
                - panel_id

    base-client-grid:
        source:
            type: orm
            acl_resource: cb_newage_client_view
            query:
                select:
                    - client.id
                    - client.title
                    - own.id as owner
                from:
                    - { table: %cb_newage_client.entity.class%, alias: client }
                join:
                    inner:
                        - { join: client.owner, alias: own }
        columns:
            id:
                label: cb.newage.client.id.label
            title:
                label: cb.newage.client.title.label

        filters:
            columns:
                title:
                    type: string
                    data_name: client.title
        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_client_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_client_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_client_api_delete_client
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_client_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_client_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_client_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    client-grid:
        extends: base-client-grid

    base-client-to-panel-view-update-grid:
        source:
            type: orm
            acl_resource: cb_newage_panel_view_view
            query:
                select:
                    - panelView.id
                    - panelView.name
                    - panel.name as panelName
                    - panel.dimensions as panelDimensions
                from:
                    - { table: %cb_newage_panel_view.entity.class%, alias: panelView }
                join:
                    left:
                        -
                            join: panelView.panel
                            alias: panel
            bind_parameters:
                - client
        sorters:
            columns:
                name:
                    data_name: panelView.name

    base-support_type-grid:
        source:
            type: orm
            acl_resource: cb_newage_support_type_view
            query:
                select:
                    - supportType.id
                    - supportType.name
                from:
                    - { table: %cb_newage_support_type.entity.class%, alias: supportType }
        columns:
            id:
                label:        cb.newage.supporttype.id.label
            name:
                label:        cb.newage.supporttype.name.label

        sorters:
            columns:
                id:
                    data_name: supportType.id
                name:
                    data_name: supportType.name
            default:
                name:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:
                name:
                    type: string
                    data_name: supportType.name
                    enabled: true

        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_support_type_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_support_type_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_support_type_api_delete_support_type
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_support_type_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_support_type_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_support_type_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    support_type-grid:
        extends: base-support_type-grid

    base-lighting_type-grid:
        source:
            type: orm
            acl_resource: cb_newage_lighting_type_view
            query:
                select:
                    - lightingType.id
                    - lightingType.name
                from:
                    - { table: %cb_newage_lighting_type.entity.class%, alias: lightingType }
        columns:
            id:
                label:        cb.newage.lightingtype.id.label
            name:
                label:        cb.newage.lightingtype.name.label

        sorters:
            columns:
                id:
                    data_name: lightingType.id
                name:
                    data_name: lightingType.name
            default:
                name:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:
                name:
                    type: string
                    data_name: lightingType.name
                    enabled: true

        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_lighting_type_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_lighting_type_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_lighting_type_api_delete_lighting_type
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_lighting_type_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_lighting_type_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_lighting_type_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    lighting_type-grid:
        extends: base-lighting_type-grid

    base-city-grid:
        source:
            type: orm
            acl_resource: cb_newage_city_view
            query:
                select:
                    - city.id
                    - city.name
                from:
                    - { table: %cb_newage_city.entity.class%, alias: city }
        columns:
            name:
                label:        cb.newage.city.name.label

        sorters:
            columns:
                name:
                    data_name: city.name

            default:
                name:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:

        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_city_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_city_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_city_api_delete_city
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_city_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_city_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_city_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    city-grid:
        extends: base-city-grid
        filters:
            columns:

    base-offer-grid:
        source:
            type: orm
            acl_resource: cb_newage_offer_view
            query:
                select:
                    - offer.id
                    - offer.name
                    - c.title as client
                    - offer.start
                    - offer.end
                from:
                    - { table: %cb_newage_offer.entity.class%, alias: offer }
                join:
                    left:
                        -
                            join: offer.client
                            alias: c

        columns:
            id:
                label:  cb.newage.offer.id.label
            name:
                label:  cb.newage.offer.name.label
            client:
                label:  cb.newage.client.entity_label
            start:
                label: cb.newage.offer.start.label
                frontend_type: date
            end:
                label: cb.newage.offer.end.label
                frontend_type: date
        sorters:
            columns:
                id:
                    data_name: offer.id
                name:
                    data_name: offer.name
                client:
                    data_name: c.title

            default:
                id:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_DESC'

        filters:
            columns:
                name:
                    type: string
                    data_name: offer.name
                client:
                    type: entity
                    data_name: offer.client
                    options:
                        field_options:
                            class: CBNewAgeBundle:Client
                start:
                    type:      date
                    data_name: offer.start
                end:
                    type:      date
                    data_name: offer.end

        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_offer_view
                params:       [ id ]
            update_link:
                type:         url
                route:        cb_newage_offer_update
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_offer_api_delete_offer
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_offer_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            update:
                type:         navigate
                acl_resource: cb_newage_offer_update
                label:        oro.grid.action.update
                icon:         edit
                link:         update_link
            delete:
                type:         delete
                acl_resource: cb_newage_offer_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    offer-grid:
        extends: base-offer-grid

    offer-items-grid:
        source:
            type: orm
            acl_resource: cb_newage_offer_view
            query:
                select:
                    - i.id
                    - i.start
                    - i.end
                    - pv.id as panelViewId
                    - pv.name as panelView
                    - pv.url as url
                    - pv.sketch as sketch
                    - p.name as panel
                    - p.dimensions
                    - p.neighborhoods
                    - st.name as support
                    - lt.name as lighting
                    - ct.name as city
                    - CONCAT(addr.street,  CONCAT(' ', addr.street2)) as address
                    - CONCAT(addr.latitude,  CONCAT(',', addr.longitude)) as gps
                    # cu linia asta nu mai merge filtru pe city
#                    - SUM(CASE WHEN ev.status IS NULL THEN 0 ELSE CASE WHEN ev.status=0 THEN 1 ELSE 0 END END) as reservations
                from:
                    - { table: %cb_newage.offer_item.entity.class%, alias: i }
                join:
                    left:
                        -
                            join: i.panelView
                            alias: pv
                        -
                            join: pv.panel
                            alias: p
                        -
                            join: p.supportType
                            alias: st
                        -
                            join: p.lightingType
                            alias: lt
                        - { join: p.addresses, alias: addr, conditionType: WITH, condition: 'addr.primary = true' }
                        -
                            join: addr.city
                            alias: ct
#                        -
#                            join: pv.events
#                            alias: ev
#                            conditionType: WITH
#                            condition: ev.status = %cb_scheduler.scheduler_event.entity.class%::RESERVED AND ((ev.start >= i.start AND ev.start <= i.end) OR (ev.end >= i.start AND ev.end <= i.end) OR (ev.start >= i.start AND ev.end <= i.end) OR (ev.start <= i.start AND ev.end >= i.end))
                where:
                    and:
                        - i.offer = :offer
            bind_parameters:
                - offer
        columns:
            id:
                label:        cb.newage.panel.id.label
#            reservations:
#                label:        "R"
            start:
                label:         cb.newage.offer.start.label
                frontend_type: date
            end:
                label:         cb.newage.offer.end.label
                frontend_type: date
            url:
                label:        cb.newage.panelview.url.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            city:
                label:        oro.address.city.label
            address:
                label:        oro.address.entity_label
            panel:
                label:        cb.newage.panel.entity_label
            support:
                label:        cb.newage.supporttype.entity_label
            dimensions:
                label:        cb.newage.panel.dimensions.label
            lighting:
                label:        cb.newage.lightingtype.entity_label
            panelView:
                label:        cb.newage.panelview.entity_label
            sketch:
                label:        cb.newage.panelview.sketch.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            neighborhoods:
                label:        cb.newage.panel.neighborhoods.label
            gps:
                label:        cb.newage.panel.address.gps.label
        sorters:
            columns:
                city:
                    data_name: ct.name
                panel:
                    data_name: p.name
                panelView:
                    data_name: pv.name
            default:
                city:       '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panel:      '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panelView:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
        filters:
            columns:
                city:
                    type:      choice
                    label:  cb.newage.city.entity_label
                    data_name: addr.city
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_city.entity.class%)
                            translatable_options: false
                support:
                    type:      choice
                    label:  cb.newage.supporttype.entity_label
                    data_name: p.supportType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_support_type.entity.class%)
                            translatable_options: false
                lighting:
                    type:      choice
                    label:  cb.newage.lightingtype.entity_label
                    data_name: p.lightingType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_lighting_type.entity.class%)
                            translatable_options: false
                dimensions:
                    type: string
                    data_name: p.dimensions
                    enabled: true

        properties:
            id: ~
            reservations_link:
                type:         url
                route:        cb_newage_offer_reservations
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_offer_item_api_delete_offer_item
                params:       [ id ]
        actions:
            reservations_view:
                type:         dialog
                label:        cb.newage.offer.reservations.label
                link:         reservations_link
                icon:         map-marker
                widgetOptions:
                    options:
                        dialogOptions:
                            title: "Reservations"
                widget:
                    reload-grid-name: popup-reservations-grid
                    options:
                        dialogOptions:
                            width: 750
                rowAction:    true
            delete:
                type:         delete
                acl_resource: cb_newage_offer_item_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link
        options:
            entityHint: offer item
#            mass_actions:
#                delete:
#                    enabled: true
            routerEnabled: false
#            export: true
        mass_actions:
            reserve:
                type: reserve
                entity_name: %cb_newage.offer_item.entity.class%
                data_identifier: i.id
                label: cb.newage.offer.datagrid.action.reserve
                icon: check-square-o

    available-panel_view-grid:
        source:
            type: orm
            entity: CBNewAgeBundle:PanelView # The name of your entity
            repository_method: getAvailablePanelViewsQueryBuilder # The function name for query builder
            acl_resource: cb_newage_panel_view_view
#            query:
#                select:
#                    - pv.id
#                    - pv.name as panelView
#                    - pv.url
#                    - pv.sketch
#                    - p.name as panel
#                    - p.dimensions
#                    - p.neighborhoods
#                    - st.name as support
#                    - lt.name as lighting
#                    - ct.name as city
#                    - CONCAT(addr.street,  CONCAT(' ', addr.street2)) as address
#                    - CONCAT(addr.latitude,  CONCAT(',', addr.longitude)) as gps
#                from:
#                    - { table: %cb_newage_panel_view.entity.class%, alias: pv }
#                join:
#                    left:
#                        -
#                            join: pv.panel
#                            alias: p
#                        -
#                            join: p.supportType
#                            alias: st
#                        -
#                            join: p.lightingType
#                            alias: lt
#                        - { join: p.addresses, alias: addr, conditionType: WITH, condition: 'addr.primary = true' }
#                        -
#                            join: addr.city
#                            alias: ct
#                where:
#                    and:
#                        - pv.id NOT IN (:forbidden)
#            bind_parameters:
#                - forbidden

        columns:
            url:
                label:        cb.newage.panelview.url.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            city:
                label:        oro.address.city.label
            address:
                label:        oro.address.entity_label
            panel:
                label:        cb.newage.panel.entity_label
            support:
                label:        cb.newage.supporttype.entity_label
            dimensions:
                label:        cb.newage.panel.dimensions.label
            lighting:
                label:        cb.newage.lightingtype.entity_label
            panelView:
                label:        cb.newage.panelview.entity_label
            sketch:
                label:        cb.newage.panelview.sketch.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            neighborhoods:
                label:        cb.newage.panel.neighborhoods.label
            gps:
                label:        cb.newage.panel.address.gps.label

#        sorters:
#            columns:
#                city:
#                    data_name: ct.name
#                panel:
#                    data_name: p.name
#                panelView:
#                    data_name: pv.name
#            default:
#                city:       '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
#                panel:      '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
#                panelView:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:
                city:
                    type:      choice
                    label:  cb.newage.city.entity_label
                    data_name: addr.city
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_city.entity.class%)
                            translatable_options: false
                support:
                    type:      choice
                    label:  cb.newage.supporttype.entity_label
                    data_name: p.supportType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_support_type.entity.class%)
                            translatable_options: false
                lighting:
                    type:      choice
                    label:  cb.newage.lightingtype.entity_label
                    data_name: p.lightingType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_lighting_type.entity.class%)
                            translatable_options: false
                dimensions:
                    type: string
                    data_name: p.dimensions
        properties:
            id: ~
        action_configuration:
            delete: false
        options:
            entityHint: panel view
            mass_actions:
                delete:
                    enabled: false
        mass_actions:
            offer:
                type: offer
                entity_name: %cb_newage_panel_view.entity.class%
                data_identifier: pv.id
                label: cb.newage.offer.datagrid.action.offer
                icon: check

    reservation-items-grid:
        source:
            type: orm
            acl_resource: cb_newage_offer_view
            query:
                select:
                    - ri.id
                    - ri.start
                    - ri.end
                    - pv.name as panelView
                    - pv.url as url
                    - pv.sketch as sketch
                    - p.name as panel
                    - p.dimensions
                    - p.neighborhoods
                    - st.name as support
                    - lt.name as lighting
                    - ct.name as city
                    - CONCAT(addr.street,  CONCAT(' ', addr.street2)) as address
                    - CONCAT(addr.latitude,  CONCAT(',', addr.longitude)) as gps
                from:
                    - { table: %cb_newage.reservation-item.entity.class%, alias: ri }
                join:
                    left:
                        -
                            join: ri.offerItem
                            alias: oi
                        -
                            join: oi.panelView
                            alias: pv
                        -
                            join: pv.panel
                            alias: p
                        -
                            join: p.supportType
                            alias: st
                        -
                            join: p.lightingType
                            alias: lt
                        - { join: p.addresses, alias: addr, conditionType: WITH, condition: 'addr.primary = true' }
                        -
                            join: addr.city
                            alias: ct
                where:
                    and:
                        - oi.offer = :offer
            bind_parameters:
                - offer

        columns:
            id:
                label:        cb.newage.panel.id.label
            start:
                label:         cb.newage.offer.start.label
                frontend_type: date
            end:
                label:         cb.newage.offer.end.label
                frontend_type: date
            url:
                label:        cb.newage.panelview.url.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            city:
                label:        oro.address.city.label
            address:
                label:        oro.address.entity_label
            panel:
                label:        cb.newage.panel.entity_label
            support:
                label:        cb.newage.supporttype.entity_label
            dimensions:
                label:        cb.newage.panel.dimensions.label
            lighting:
                label:        cb.newage.lightingtype.entity_label
            panelView:
                label:        cb.newage.panelview.entity_label
            sketch:
                label:        cb.newage.panelview.sketch.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            neighborhoods:
                label:        cb.newage.panel.neighborhoods.label
            gps:
                label:        cb.newage.panel.address.gps.label

        sorters:
            columns:
                city:
                    data_name: ct.name
                panel:
                    data_name: p.name
                panelView:
                    data_name: pv.name
                start:
                    data_name: ri.start
            default:
                city:       '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panel:      '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panelView:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                start:      '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:
                city:
                    type:      choice
                    label:  cb.newage.city.entity_label
                    data_name: addr.city
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_city.entity.class%)
                            translatable_options: false

                support:
                    type:      choice
                    label:  cb.newage.supporttype.entity_label
                    data_name: p.supportType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_support_type.entity.class%)
                            translatable_options: false
                lighting:
                    type:      choice
                    label:  cb.newage.lightingtype.entity_label
                    data_name: p.lightingType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_lighting_type.entity.class%)
                            translatable_options: false

                dimensions:
                    type: string
                    data_name: p.dimesnions
                    enabled: true

        properties:
            id: ~
            delete_link:
                type:         url
                route:        cb_newage_reservation_item_api_delete_reservation_item
                params:       [ id ]
        actions:
            delete:
                type:         delete
                acl_resource: cb_newage_reservation_item_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link
        options:
            entityHint: reservation item
#            mass_actions:
#                delete:
#                    enabled: false
            routerEnabled: false
#            export: true
        mass_actions:
            confirm:
                type: confirm
                entity_name: %cb_newage.reservation-item.entity.class%
                data_identifier: ri.id
                label: cb.newage.offer.datagrid.action.confirm
                icon: check-square

    confirmed-items-grid:
        source:
            type: orm
            acl_resource: cb_newage_offer_view
            query:
                select:
                    - ev.id
                    - ev.start
                    - ev.end
                    - pv.name as panelView
                    - pv.url as url
                    - pv.sketch as sketch
                    - p.name as panel
                    - p.dimensions
                    - p.neighborhoods
                    - st.name as support
                    - lt.name as lighting
                    - ct.name as city
                    - CONCAT(addr.street,  CONCAT(' ', addr.street2)) as address
                    - CONCAT(addr.latitude,  CONCAT(',', addr.longitude)) as gps
                from:
                    - { table: %cb_scheduler.scheduler_event.entity.class%, alias: ev }
                join:
                    left:
                        -
                            join: ev.reservationItem
                            alias: ri
                        -
                            join: ri.offerItem
                            alias: oi
                        -
                            join: oi.panelView
                            alias: pv
                        -
                            join: pv.panel
                            alias: p
                        -
                            join: p.supportType
                            alias: st
                        -
                            join: p.lightingType
                            alias: lt
                        - { join: p.addresses, alias: addr, conditionType: WITH, condition: 'addr.primary = true' }
                        -
                            join: addr.city
                            alias: ct
                where:
                    and:
                        - oi.offer = :offer
                        - ev.status = %cb_scheduler.scheduler_event.entity.class%::CONFIRMED
            bind_parameters:
                - offer

        columns:
            id:
                label:        cb.newage.panel.id.label
            start:
                label:         cb.newage.offer.start.label
                frontend_type: date
            end:
                label:         cb.newage.offer.end.label
                frontend_type: date
            url:
                label:        cb.newage.panelview.url.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            city:
                label:        oro.address.city.label
            address:
                label:        oro.address.entity_label
            panel:
                label:        cb.newage.panel.entity_label
            support:
                label:        cb.newage.supporttype.entity_label
            dimensions:
                label:        cb.newage.panel.dimensions.label
            lighting:
                label:        cb.newage.lightingtype.entity_label
            panelView:
                label:        cb.newage.panelview.entity_label
            sketch:
                label:        cb.newage.panelview.sketch.label
                type: twig
                frontend_type: html
                template: CBNewAgeBundle:Datagrid:Property/url.html.twig
            neighborhoods:
                label:        cb.newage.panel.neighborhoods.label
            gps:
                label:        cb.newage.panel.address.gps.label

        sorters:
            columns:
                city:
                    data_name: ct.name
                panel:
                    data_name: p.name
                panelView:
                    data_name: pv.name
                start:
                    data_name: ev.start
            default:
                city:       '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panel:      '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                panelView:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
                start:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'

        filters:
            columns:
                city:
                    type:      choice
                    label:  cb.newage.city.entity_label
                    data_name: addr.city
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_city.entity.class%)
                            translatable_options: false

                support:
                    type:      choice
                    label:  cb.newage.supporttype.entity_label
                    data_name: p.supportType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_support_type.entity.class%)
                            translatable_options: false
                lighting:
                    type:      choice
                    label:  cb.newage.lightingtype.entity_label
                    data_name: p.lightingType
                    null_value: _empty_
                    options:
                        field_options:
                            multiple:       true
                            choices:        @cb_newage.multiple_choice.datagrid_helper->getValues(%cb_newage_lighting_type.entity.class%)
                            translatable_options: false
                dimensions:
                    type: string
                    data_name: p.dimesnions
                    enabled: true

        properties:
            id: ~
            delete_link:
                type:         url
                route:        cb_api_delete_schedulerevent
                params:       [ id ]
        actions:
            delete:
                type:         delete
                acl_resource: cb_scheduler_event_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link
#        action_configuration:
#            delete: false
        options:
            entityHint: reservation item
#            mass_actions:
#                delete:
#                    enabled: false
            routerEnabled: false
#            export: true

    old_offers-grid:
        source:
            type: orm
            entity: CBNewAgeBundle:Offer # The name of your entity
            repository_method: getUnconfirmedOffersQueryBuilder # The function name for query builder
            bind_parameters:
                - ten_days_before_current_date
        columns:
            id:
                label:  cb.newage.offer.id.label
            name:
                label:  cb.newage.offer.name.label
            client:
                label:  cb.newage.client.entity_label
            start:
                label: cb.newage.offer.start.label
                frontend_type: date
            end:
                label: cb.newage.offer.end.label
                frontend_type: date
        sorters:
            columns:
                id:
                    data_name: o.id
                name:
                    data_name: o.name
                client:
                    data_name: c.title
                start:
                    data_name: o.start
                end:
                    data_name: o.end
            default:
                end:  '%oro_datagrid.extension.orm_sorter.class%::DIRECTION_ASC'
        properties:
            id: ~
            view_link:
                type:         url
                route:        cb_newage_offer_view
                params:       [ id ]
            delete_link:
                type:         url
                route:        cb_newage_offer_api_delete_offer
                params:       [ id ]
        actions:
            view:
                type:         navigate
                acl_resource: cb_newage_offer_view
                label:        oro.grid.action.view
                icon:         eye-open
                link:         view_link
                rowAction:    true
            delete:
                type:         delete
                acl_resource: cb_newage_offer_delete
                label:        oro.grid.action.delete
                icon:         trash
                link:         delete_link

    dashboard-old_offers-grid:
        extends: old_offers-grid
        options:
            entityHint: offer
            toolbarOptions:
                hide: true
                pageSize:
                    items: [10]
                    default_per_page: 10